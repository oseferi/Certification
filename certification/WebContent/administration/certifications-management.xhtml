<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">

<h:head>
<title>Certifications Management Area</title>
<h:outputScript library="primefaces" name="jquery/jquery.js" target="head" />
<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet"></link>
</h:head>

<h:body>
<h:form id="certificationsForm">
    <p:commandButton value="Add new Certificate"  onclick="PF('newCertificateDialog').show()" />	
	<p:commandButton value="Certificates"  onclick="PF('certificatesDialog').show()" />	
	<p:commandButton value="Assign Certification"  onclick="PF('assignCertificationDialog').show()" />	
	
	<p:dataTable id="certificationTable" var="certification" value="#{managerCertificationBean.certifications}"
				 widgetVar="certificationsTable" multiViewState="true"
                 rows="10" paginator="true" 
                 paginatorPosition="bottom"
                 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} 
                 {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                 rowsPerPageTemplate="5,10,15"
                 selectionMode="single" 
                 selection="#{managerCertificationBean.certification}" 
                 rowKey="#{certification}"
                 emptyMessage="No employees found with given criteria" 
                 filteredValue="#{managerCertificationBean.filteredCertifications}"
                 >
                  
	 		<f:facet name="header">
	            <p:outputPanel>
	                <h:outputText value="Search all fields:" />
	                <p:inputText id="globalFilter" onkeyup="PF('certificationsTable').filter()" 
	                	style="width:150px" placeholder="Enter keyword"/>
	            </p:outputPanel>
	        </f:facet>
	        
	 	    <p:ajax event="rowSelect" update=":certificationsForm:certificationDetail" oncomplete="PF('certificationDialog').show()" />
	 
			<p:column id="table_header_name" filterMatchMode="contains" 
				filterBy="#{certification.user.name}"  sortBy="#{certification.user.name}">
				<f:facet name="header" >Name</f:facet>
				<h:outputText value="#{certification.user.name}" />
			</p:column>
			
			<p:column id="table_header_surname" filterMatchMode="contains"  
				filterBy="#{certification.user.surname}" sortBy="#{certification.user.surname}">
				<f:facet name="header">Surname</f:facet>
				<h:outputText value="#{certification.user.surname}" />
			</p:column>
			
			<p:column id="table_header_address" filterMatchMode="contains" 
				filterBy="#{certification.certificate.title}" sortBy="#{certification.certificate.title}">
				<f:facet name="header">Certificate</f:facet>
				<h:outputText value="#{certification.certificate.title}" />
			</p:column>
			
			<p:column id="table_header_date" >
				<f:facet name="header">Date</f:facet>
				<h:outputText value="#{certification.status}" />
			</p:column>
			
			<p:column >
				<p:commandLink action="#{managerCertificationBean.edit(certification)}" >
					<i class="fa fa-pencil"></i>
				</p:commandLink>
				<p:commandLink 
				action="#{managerCertificationBean.removeCertification(certification.id)}" 
				update=":certificationsForm:certificationTable :certificationsForm:growl1" >
					<i class="fa fa-trash"></i>
				</p:commandLink>
			</p:column>
		</p:dataTable>
		<p:growl id="growl1" showDetail="true" severity="info" sticky="true" />  
		<p:dialog header="Certification Info" widgetVar="certificationDialog"  showEffect="fade" hideEffect="fade" resizable="false">
	        <p:outputPanel id="certificationDetail" >
				<h4><h:outputLabel>Name:</h:outputLabel></h4>
				<i><h:outputText value="#{managerCertificationBean.certification.user.name}" /></i>
				<h4><h:outputLabel>Surname:</h:outputLabel></h4>
				<i><h:outputText value="#{managerCertificationBean.certification.user.surname}" /></i>
				<h4><h:outputLabel>Certificate Title:</h:outputLabel></h4>
				<i><h:outputText value="#{managerCertificationBean.certification.certificate.title}" /></i>
				<h4><h:outputLabel>Certificate Description:</h:outputLabel></h4>
				<i><h:outputText value="#{managerCertificationBean.certification.certificate.description}" /></i>
				<h4><h:outputLabel>Date Assigned:</h:outputLabel></h4>
				<i><h:outputText value="#{managerCertificationBean.certification.dateAssigned}" /></i>
				<h4><h:outputLabel>Status</h:outputLabel></h4>
				<i><h:outputText value="#{managerCertificationBean.certification.status}" /></i>
	        </p:outputPanel>
    	</p:dialog>
	</h:form>
	
	<h:form id="assignCertificateForm">
		<p:dialog header="Assign Certification" widgetVar="assignCertificationDialog"  
				  showEffect="fade" hideEffect="fade" resizable="false">
	        <p:outputPanel id="assignCertificationDetail" 
	        	style="text-align:center;">

	        	<p:selectOneMenu 
				id="assign_user_Certification"  
				value="#{managerCertificationBean.userId}" 
				lazy="true" style="width:125px" required="true">
		            <f:selectItem itemLabel="Select One" itemValue="" />
		            <f:selectItems var="employee"
			            value="#{managerCertificationBean.employees}"
			            itemLabel="#{employee.name} #{employee.surname}"
			            itemValue="#{employee.id}" />
		        </p:selectOneMenu>
		         <p:message for ="assign_user_Certification"/>
		         
		        <p:selectOneMenu 
				id="assign_certificate_Certification"
				value="#{managerCertificationBean.certificateId}" 
				lazy="true" style="width:125px" required="true">
		            <f:selectItem itemLabel="Select One" itemValue="" />
		            <f:selectItems var="certificate"
			            value="#{managerCertificationBean.certificates}"
			            itemLabel="#{certificate.title}"
			            itemValue="#{certificate.id}" />
		        </p:selectOneMenu>
		        <p:message for ="assign_certificate_Certification"/>
	        </p:outputPanel>
		        <p:commandButton value="Assign" 
		        action="#{managerCertificationBean.assignCertification()}"
		        update="certificationsForm:certificationTable :certificationsForm:growl1 :assignCertificateForm:assignCertificationDetail">
		        </p:commandButton>
    	</p:dialog>
	</h:form>
	
	<h:form id="certificatesForm">
      <p:dialog header="All certificates" id="allcertificates" widgetVar="certificatesDialog"  
      			showEffect="fade" hideEffect="fade" resizable="false">
	    <p:dataTable id="certificates" 
	    	var="certificate" value="#{managerCertificationBean.certificates}"
	    	multiViewState="true" rows="10" paginator="true" paginatorPosition="bottom">
	        <p:column headerText="Title">
	            <h:outputText value="#{certificate.title}" />
	        </p:column>
	        <p:column headerText="Description">
	            <h:outputText value="#{certificate.description}" />
	        </p:column>
	        <p:column headerText="Technology">
	            <h:outputText value="#{certificate.technology.title}" />
	        </p:column>
	        <p:column style="width:32px;text-align: center">
	             <p:commandButton 
	             update=":certificatesForm:certificates :certificationsForm:growl1"  
	             icon="ui-icon-trash" 
	             title="Remove" 
	             action="#{managerCertificationBean.removeCertificate(certificate.id)}">
	            </p:commandButton>
	        </p:column>
	    </p:dataTable>
	   </p:dialog>
	  
    	<p:dialog header="New Certificate" widgetVar="newCertificateDialog">
    		<p:outputPanel id="newCertificateDetails">
				<p:inputText id="new_certificate_title" 
				value="#{managerCertificationBean.certificate.title}" 
				pt:placeholder="Title" required="true"></p:inputText>
				<p:message for="new_certificate_title" />
				
				<p:inputText id="new_certificate_Description" 
				value="#{managerCertificationBean.certificate.description}"
				 pt:placeholder="Description" required="true"></p:inputText>
				<p:message for="new_certificate_Description" />
				
				<p:selectOneMenu 
				id="new_certificate_technology"  
				converter="#{technologyConverter}"
				value="#{managerCertificationBean.certificate.technology}" 
				lazy="true" style="width:125px" required="true">
		            <f:selectItem itemLabel="Select One" itemValue="" />
		            <f:selectItems var="technology"
			            value="#{managerCertificationBean.technologies}"
			            itemLabel="#{technology.title}"
			            itemValue="#{technology}" />
		        </p:selectOneMenu>	
		        <p:message for="new_certificate_technology" />
		        
		        <p:commandButton action="#{managerCertificationBean.addCertificate()}" 
		        type="submit"
		        oncomplete="if (args &amp;&amp; !args.validationFailed) { PF('newCertificateDialog').hide();PF('certificatesDialog').show()}"
		        update=":certificatesForm:certificates :certificationsForm:growl1 "
		        value="Add Certificate">
		        </p:commandButton>			
    		</p:outputPanel>
    	</p:dialog>

</h:form>
</h:body>
</html>
